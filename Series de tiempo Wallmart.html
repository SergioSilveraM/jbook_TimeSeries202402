

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>&lt;no title&gt; &#8212; EDA Dataset Walmart</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Series de tiempo Wallmart';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/LogoU.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/LogoU.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Acerca de
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="EDADatasetWalmart.html"><strong><em>Predicción de la Demanda en Tiendas Walmart Utilizando un Enfoque Híbrido SARIMA y MLP</em></strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="BonificacionPractica1.html">Bonificación Práctica 1</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FSeries de tiempo Wallmart.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Series de tiempo Wallmart.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1><no title></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="simple visible nav section-nav flex-column">
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <p>##Tarea##</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Librerias necesarias</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.seasonal</span> <span class="kn">import</span> <span class="n">seasonal_decompose</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.arima.model</span> <span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">adfuller</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">LSTM</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
</div>
<p>Enhanced Machine Learning Models for Churn Prediction and Retention Analysis</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reads data from PB1</span>
<span class="n">QUERY</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM SCHEMA.TABLE&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">hana</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="n">QUERY</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Reads data from PB1</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">QUERY</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM SCHEMA.TABLE&quot;</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">data</span> <span class="o">=</span> <span class="n">hana</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="n">QUERY</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;hana&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>ventas semanales en tiendas de Walmart. Las columnas incluyen:</p>
<p>Store: Número de tienda.
Date: Fecha de las ventas.
Weekly_Sales: Ventas semanales en dólares.
Holiday_Flag: Indica si es una semana de vacaciones (1) o no (0).
Temperature: Temperatura en grados Fahrenheit.
Fuel_Price: Precio del combustible en dólares por galón.
CPI: Índice de Precios al Consumidor.
Unemployment: Tasa de desempleo.
Para el análisis exploratorio de datos (EDA) enfocado en series de tiempo, procederemos de la siguiente manera:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#importamos los datos en la ruta</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;C:/Users/a843931/OneDrive - Yara International ASA/Documents/Maestria analisis de dato/Series de tiempo/Series de tiempo Python/Data_base/walmart-sales-dataset-of-45stores.csv&#39;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Store</th>
      <th>Date</th>
      <th>Weekly_Sales</th>
      <th>Holiday_Flag</th>
      <th>Temperature</th>
      <th>Fuel_Price</th>
      <th>CPI</th>
      <th>Unemployment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>05-02-2010</td>
      <td>1643690.90</td>
      <td>0</td>
      <td>42.31</td>
      <td>2.572</td>
      <td>211.096358</td>
      <td>8.106</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>12-02-2010</td>
      <td>1641957.44</td>
      <td>1</td>
      <td>38.51</td>
      <td>2.548</td>
      <td>211.242170</td>
      <td>8.106</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>19-02-2010</td>
      <td>1611968.17</td>
      <td>0</td>
      <td>39.93</td>
      <td>2.514</td>
      <td>211.289143</td>
      <td>8.106</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>26-02-2010</td>
      <td>1409727.59</td>
      <td>0</td>
      <td>46.63</td>
      <td>2.561</td>
      <td>211.319643</td>
      <td>8.106</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>05-03-2010</td>
      <td>1554806.68</td>
      <td>0</td>
      <td>46.50</td>
      <td>2.625</td>
      <td>211.350143</td>
      <td>8.106</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6430</th>
      <td>45</td>
      <td>28-09-2012</td>
      <td>713173.95</td>
      <td>0</td>
      <td>64.88</td>
      <td>3.997</td>
      <td>192.013558</td>
      <td>8.684</td>
    </tr>
    <tr>
      <th>6431</th>
      <td>45</td>
      <td>05-10-2012</td>
      <td>733455.07</td>
      <td>0</td>
      <td>64.89</td>
      <td>3.985</td>
      <td>192.170412</td>
      <td>8.667</td>
    </tr>
    <tr>
      <th>6432</th>
      <td>45</td>
      <td>12-10-2012</td>
      <td>734464.36</td>
      <td>0</td>
      <td>54.47</td>
      <td>4.000</td>
      <td>192.327265</td>
      <td>8.667</td>
    </tr>
    <tr>
      <th>6433</th>
      <td>45</td>
      <td>19-10-2012</td>
      <td>718125.53</td>
      <td>0</td>
      <td>56.47</td>
      <td>3.969</td>
      <td>192.330854</td>
      <td>8.667</td>
    </tr>
    <tr>
      <th>6434</th>
      <td>45</td>
      <td>26-10-2012</td>
      <td>760281.43</td>
      <td>0</td>
      <td>58.85</td>
      <td>3.882</td>
      <td>192.308899</td>
      <td>8.667</td>
    </tr>
  </tbody>
</table>
<p>6435 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convertir la columna &#39;Date&#39; a tipo fecha para el análisis de series de tiempo</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%m-%Y&#39;</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Verificar si hay datos faltantes</span>
<span class="n">missing_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Resumen estadístico de las ventas semanales</span>
<span class="n">sales_summary</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Weekly_Sales&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gráfico de las ventas semanales de una tienda específica para ver su comportamiento a lo largo del tiempo</span>
<span class="n">store_1_sales</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Store&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;Weekly_Sales&#39;</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">store_1_sales</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ventas semanales - Tienda 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comportamiento de las Ventas Semanales (Tienda 1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ventas Semanales (USD)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Mostrar el resumen de ventas y los datos faltantes</span>
<span class="n">missing_data</span><span class="p">,</span> <span class="n">sales_summary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8821a255c976cf659bc2328e663eb1445424a0b768da388162322480c7485c97.png" src="_images/8821a255c976cf659bc2328e663eb1445424a0b768da388162322480c7485c97.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(Store           0
 Weekly_Sales    0
 Holiday_Flag    0
 Temperature     0
 Fuel_Price      0
 CPI             0
 Unemployment    0
 dtype: int64,
 count    6.435000e+03
 mean     1.046965e+06
 std      5.643666e+05
 min      2.099862e+05
 25%      5.533501e+05
 50%      9.607460e+05
 75%      1.420159e+06
 max      3.818686e+06
 Name: Weekly_Sales, dtype: float64)
</pre></div>
</div>
</div>
</div>
<p><strong>Exploración inicial de los datos:</strong>
Datos faltantes: No hay datos faltantes en ninguna de las columnas. Esto es un buen indicio, ya que no será necesario realizar imputación de datos.</p>
<p><em>Estadísticas descriptivas de ventas semanales:</em></p>
<p>Promedio de ventas semanales: <span class="math notranslate nohighlight">\(1,046,965.00
Desviación estándar: \)</span>564,366.60
Ventas mínimas: <span class="math notranslate nohighlight">\(209,986.20
Ventas máximas: \)</span>3,818,686.00
El rango de ventas es considerablemente amplio, lo que sugiere variabilidad significativa entre tiendas y semanas. Este es un punto importante para los modelos de series de tiempo, ya que puede indicar la presencia de outliers en semanas específicas.</p>
<p><strong>Comportamiento de las ventas:</strong></p>
<p>El gráfico de las ventas semanales de la Tienda 1 revela fluctuaciones regulares, lo que indica una posible estacionalidad. También es probable que los picos correspondan a semanas de eventos como feriados o promociones especiales, lo cual será útil para modelar la serie temporal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aplicar una técnica de suavización (Media móvil) para identificar la tendencia subyacente en las ventas</span>
<span class="n">store_1_sales_smooth</span> <span class="o">=</span> <span class="n">store_1_sales</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Graficar las ventas originales junto con la serie suavizada para detectar la tendencia</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">store_1_sales</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ventas semanales - Tienda 1&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">store_1_sales_smooth</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Tendencia Suavizada (Media móvil de 12 semanas)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ventas Semanales con Suavización (Tienda 1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ventas Semanales (USD)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># Descomposición aditiva de la serie de tiempo para observar tendencia, estacionalidad y residuales</span>
<span class="n">decomposition</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">store_1_sales</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">52</span><span class="p">)</span>  <span class="c1"># Ciclo anual (52 semanas)</span>
<span class="n">trend</span> <span class="o">=</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">trend</span>
<span class="n">seasonal</span> <span class="o">=</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">seasonal</span>
<span class="n">residual</span> <span class="o">=</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">resid</span>

<span class="c1"># Graficar la descomposición de la serie de tiempo</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">411</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">store_1_sales</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ventas semanales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">412</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trend</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Tendencia&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">seasonal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Estacionalidad&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">414</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">residual</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residuales&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/834a6c44a42c9579538617616228d6117196aeacb8789ed288e52cc691837da4.png" src="_images/834a6c44a42c9579538617616228d6117196aeacb8789ed288e52cc691837da4.png" />
<img alt="_images/8c1c24f91519df373ee2f0b8cb64557b6d87a4bc943f3913a9fc6d0b96bfd63d.png" src="_images/8c1c24f91519df373ee2f0b8cb64557b6d87a4bc943f3913a9fc6d0b96bfd63d.png" />
</div>
</div>
<p>Análisis de Suavización y Estacionalidad
Suavización (Media móvil de 12 semanas):</p>
<p>La suavización ha permitido resaltar la tendencia subyacente de las ventas semanales. Observamos un comportamiento cíclico, lo que sugiere la presencia de estacionalidad en los datos. Los picos más pronunciados parecen coincidir con semanas festivas o eventos especiales.
Descomposición de la serie de tiempo:</p>
<p>Tendencia: La serie de ventas muestra una tendencia estable con altibajos moderados. No se observan grandes aumentos o disminuciones consistentes a lo largo del tiempo.
Estacionalidad: Hay una estacionalidad clara con fluctuaciones cíclicas anuales, lo cual es coherente con el tipo de ventas que estamos analizando. Se puede esperar que ciertos picos de ventas se repitan en fechas importantes como Navidad y el Super Bowl.
Residuales: La serie de residuales parece tener un comportamiento más aleatorio, lo cual es un buen indicio, ya que los modelos como ARIMA o el híbrido propuesto deberían ser capaces de capturar adecuadamente la tendencia y estacionalidad, dejando los residuales como ruido aleatorio.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Selecting the variables for correlation analysis</span>
<span class="n">variables_for_correlation</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Weekly_Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;Temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;Fuel_Price&#39;</span><span class="p">,</span> <span class="s1">&#39;CPI&#39;</span><span class="p">,</span> <span class="s1">&#39;Unemployment&#39;</span><span class="p">]]</span>

<span class="c1"># Calculating the correlation matrix</span>
<span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">variables_for_correlation</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Correlation Matrix: Weekly Sales vs Other Variables&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0708c3e47507adc447fc5232d64181464a5c14133384d9ac34c108ec266f48ba.png" src="_images/0708c3e47507adc447fc5232d64181464a5c14133384d9ac34c108ec266f48ba.png" />
</div>
</div>
<p>Próximos pasos:
Comparación de modelos:</p>
<p>ARIMA para captar la estructura autorregresiva y de medias móviles de los datos.
ETS (Exponential Smoothing) para series con tendencia y estacionalidad.
Redes Neuronales Artificiales (ANN) para aprovechar la capacidad de los modelos no lineales en la predicción.
Hibridación de modelos (ANN + ARIMA):</p>
<p>Aplicaremos un modelo híbrido para combinar la capacidad de ARIMA en series temporales lineales con la potencia de las Redes Neuronales para capturar patrones más complejos y no lineales.</p>
<p><strong>Preparación de los datos para ARIMA</strong>
ARIMA requiere que los datos sean estacionarios, es decir, que no presenten tendencia o estacionalidad significativa a lo largo del tiempo. Los pasos típicos incluyen:</p>
<p>Diferenciación de la serie para eliminar tendencias y estacionalidad.
Prueba de estacionariedad usando la prueba de Dickey-Fuller aumentada (ADF) para verificar si los datos ya son estacionarios o necesitan más transformaciones.
2. Preparación de los datos para Redes Neuronales Artificiales (ANN)
Las redes neuronales requieren datos normalizados y un enfoque diferente:</p>
<p>Normalización de los datos: Escalar las ventas semanales a un rango entre 0 y 1 o entre -1 y 1 para facilitar el entrenamiento del modelo.
Estructuración del conjunto de datos: Dado que ANN trabaja mejor con ventanas de tiempo (lag windows), debemos generar datos con secuencias temporales (e.g., predecir las ventas futuras a partir de las ventas pasadas en una ventana de 5 semanas).</p>
<p><strong>Paso 1: Prueba de estacionariedad y diferenciación para ARIMA</strong>
Voy a realizar la prueba de Dickey-Fuller y luego, si es necesario, aplicar la diferenciación de la serie para hacerla estacionaria.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prueba de Dickey-Fuller Aumentada (ADF) para verificar la estacionariedad de las ventas de la Tienda 1</span>
<span class="n">adf_result</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">store_1_sales</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span> 

<span class="c1"># Interpretación de la prueba ADF</span>
<span class="n">adf_statistic</span> <span class="o">=</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">adf_p_value</span> <span class="o">=</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">adf_critical_values</span> <span class="o">=</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

<span class="c1"># Aplicar diferenciación si los datos no son estacionarios</span>
<span class="k">if</span> <span class="n">adf_p_value</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">:</span>  
    <span class="n">store_1_sales_diff</span> <span class="o">=</span> <span class="n">store_1_sales</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">adf_result_diff</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">store_1_sales_diff</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">store_1_sales_diff</span> <span class="o">=</span> <span class="n">store_1_sales</span>

<span class="c1"># Resultados de la prueba ADF y diferenciación</span>
<span class="p">(</span><span class="n">adf_statistic</span><span class="p">,</span> <span class="n">adf_p_value</span><span class="p">,</span> <span class="n">adf_critical_values</span><span class="p">),</span> <span class="n">store_1_sales_diff</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((-5.102186145192287,
  1.3877788330759535e-05,
  {&#39;1%&#39;: -3.47864788917503,
   &#39;5%&#39;: -2.882721765644168,
   &#39;10%&#39;: -2.578065326612056}),
 Date
 2010-02-05    1643690.90
 2010-02-12    1641957.44
 2010-02-19    1611968.17
 2010-02-26    1409727.59
 2010-03-05    1554806.68
 Name: Weekly_Sales, dtype: float64)
</pre></div>
</div>
</div>
</div>
<p>El p-valor es muy bajo (menor que 0.05), lo que indica que los datos ya son estacionarios. No será necesario aplicar diferenciación adicional para el modelo ARIMA.</p>
<p>Normalización: Escalar los datos de ventas semanales.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalización de los datos de ventas semanales</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">store_1_sales_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">store_1_sales</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Función para crear secuencias temporales (ventanas de tiempo) para el modelo ANN</span>
<span class="k">def</span> <span class="nf">create_sequences</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">window_size</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">window_size</span><span class="p">):</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">window_size</span><span class="p">])</span>
        <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">window_size</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># Crear secuencias con una ventana de tiempo de 12 semanas</span>
<span class="n">window_size</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">create_sequences</span><span class="p">(</span><span class="n">store_1_sales_scaled</span><span class="p">,</span> <span class="n">window_size</span><span class="p">)</span>

<span class="c1"># Mostrar las primeras secuencias generadas</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((131, 12, 1),
 (131, 1),
 array([[[0.30511304],
         [0.30349457],
         [0.27549472],
         [0.08667028],
         [0.22212518],
         [0.11450649],
         [0.14529326],
         [0.08172404],
         [0.25962256],
         [0.21335982],
         [0.13926413],
         [0.06942416]]]),
 array([[0.10102358]]))
</pre></div>
</div>
</div>
</div>
<p>Preparación para Redes Neuronales Artificiales (ANN)
Normalización de los datos: Las ventas semanales han sido escaladas al rango entre 0 y 1, lo que es esencial para mejorar el rendimiento del modelo ANN.
Secuencias temporales (ventanas de tiempo): Hemos creado secuencias de datos con una ventana de 12 semanas. Cada ventana contiene las ventas de las últimas 12 semanas, y el objetivo es predecir la semana siguiente.
Tamaño del conjunto de secuencias:</p>
<p>131 secuencias de 12 semanas de ventas, listas para entrenar el modelo ANN.</p>
<p>Implementación del Modelo ARIMA
Dado que los datos de ventas semanales son estacionarios y presentan estacionalidad anual, vamos a proceder con el ajuste de un modelo ARIMA. También evaluaremos un posible ajuste con SARIMA (ARIMA estacional), si detectamos un fuerte componente estacional en los resultados.</p>
<p>Voy a proceder con el ajuste del modelo ARIMA utilizando las ventas de la Tienda 1, y evaluaré los parámetros óptimos usando la técnica de diferenciación automática para seleccionar el mejor modelo (auto-ARIMA).</p>
<p>Procederé con la implementación y evaluación del modelo ARIMA.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ajustar un modelo ARIMA(1,0,1) preliminar basado en la estacionariedad observada previamente</span>
<span class="n">arima_order</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  
</pre></div>
</div>
</div>
</div>
<p>Creacion del modelo Arima</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Crear el modelo ARIMA</span>
<span class="n">arima_model</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">store_1_sales</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">arima_order</span><span class="p">)</span>
<span class="n">arima_fitted</span> <span class="o">=</span> <span class="n">arima_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Realizar predicciones en el conjunto de datos original</span>
<span class="n">arima_predictions</span> <span class="o">=</span> <span class="n">arima_fitted</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">store_1_sales</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcular el error cuadrático medio (MSE)</span>
<span class="n">mse_arima</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">store_1_sales</span><span class="p">,</span> <span class="n">arima_predictions</span><span class="p">)</span>
<span class="n">rmse_arima</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse_arima</span><span class="p">)</span>

<span class="c1"># Graficar las predicciones y las ventas reales</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">store_1_sales</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ventas Reales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">arima_predictions</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicciones ARIMA(3,0,0)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Predicción ARIMA(1,0,1) - RMSE: </span><span class="si">{</span><span class="n">rmse_arima</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ventas Semanales (USD)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Mostrar el RMSE</span>
<span class="n">rmse_arima</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\a843931\AppData\Local\miniconda3\envs\ml_venv\lib\site-packages\statsmodels\tsa\base\tsa_model.py:473: ValueWarning: No frequency information was provided, so inferred frequency W-FRI will be used.
  self._init_dates(dates, freq)
c:\Users\a843931\AppData\Local\miniconda3\envs\ml_venv\lib\site-packages\statsmodels\tsa\base\tsa_model.py:473: ValueWarning: No frequency information was provided, so inferred frequency W-FRI will be used.
  self._init_dates(dates, freq)
c:\Users\a843931\AppData\Local\miniconda3\envs\ml_venv\lib\site-packages\statsmodels\tsa\base\tsa_model.py:473: ValueWarning: No frequency information was provided, so inferred frequency W-FRI will be used.
  self._init_dates(dates, freq)
</pre></div>
</div>
<img alt="_images/c89983bc9bcc8fdecc24e3de13fb0bee9bbab4d27c8a5df59c7cbccc876c2af7.png" src="_images/c89983bc9bcc8fdecc24e3de13fb0bee9bbab4d27c8a5df59c7cbccc876c2af7.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>148055.63709421252
</pre></div>
</div>
</div>
</div>
<p>Resultados del modelo ARIMA (3),0,0)
Root Mean Squared Error (RMSE): 148,022.71 USD. Este valor mide el error promedio de las predicciones y es una métrica útil para evaluar la precisión del modelo. Cuanto más bajo sea el RMSE, mejor será el ajuste del modelo.
Predicciones vs. ventas reales: El gráfico muestra cómo el modelo ARIMA predice las ventas semanales. Las predicciones siguen de cerca el comportamiento real de las ventas, pero podemos notar algunas diferencias en ciertos picos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Asegurar que ambas series tengan el mismo índice y estén alineadas</span>
<span class="n">holiday_flag_aligned</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">store_1_sales</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Holiday_Flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Alinear la variable exógena con las fechas de ventas</span>

<span class="c1"># Verificar que los tamaños coincidan</span>
<span class="n">aligned_lengths</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">store_1_sales</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">holiday_flag_aligned</span><span class="p">))</span>

<span class="c1"># Si los tamaños coinciden, ajustar el modelo SARIMA</span>
<span class="k">if</span> <span class="n">aligned_lengths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">aligned_lengths</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">sarima_model</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">store_1_sales</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">sarima_order</span><span class="p">,</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="n">seasonal_order</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">holiday_flag_aligned</span><span class="p">)</span>
    <span class="n">sarima_fitted</span> <span class="o">=</span> <span class="n">sarima_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

    <span class="c1"># Realizar predicciones en el conjunto de datos original</span>
    <span class="n">sarima_predictions</span> <span class="o">=</span> <span class="n">sarima_fitted</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">store_1_sales</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">holiday_flag_aligned</span><span class="p">)</span>

    <span class="c1"># Calcular el error cuadrático medio (MSE) del modelo SARIMA con variable exógena</span>
    <span class="n">mse_sarima</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">store_1_sales</span><span class="p">,</span> <span class="n">sarima_predictions</span><span class="p">)</span>
    <span class="n">rmse_sarima</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse_sarima</span><span class="p">)</span>

    <span class="c1"># Graficar las predicciones SARIMA con las ventas reales</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">store_1_sales</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ventas Reales&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sarima_predictions</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicciones SARIMA(1,0,1)(1,0,1,52)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Predicción SARIMA con Variable Exógena (RMSE: </span><span class="si">{</span><span class="n">rmse_sarima</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ventas Semanales (USD)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Mostrar el nuevo RMSE</span>
    <span class="n">rmse_sarima</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">aligned_lengths</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dividir los datos en entrenamiento y prueba</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Crear el modelo ANN usando una arquitectura simple con capas LSTM</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">window_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>  
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> 

<span class="c1"># Compilar el modelo</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mean_squared_error&#39;</span><span class="p">)</span>

<span class="c1"># Entrenar el modelo</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Realizar predicciones</span>
<span class="n">ann_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Desnormalizar las predicciones para comparar con las ventas reales</span>
<span class="n">ann_predictions_rescaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">ann_predictions</span><span class="p">)</span>

<span class="c1"># Calcular el RMSE del modelo ANN</span>
<span class="n">rmse_ann</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">ann_predictions_rescaled</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/50
4/4 [==============================] - 9s 669ms/step - loss: 0.0850 - val_loss: 0.0627
Epoch 2/50
4/4 [==============================] - 0s 71ms/step - loss: 0.0724 - val_loss: 0.0509
Epoch 3/50
4/4 [==============================] - 0s 48ms/step - loss: 0.0625 - val_loss: 0.0393
Epoch 4/50
4/4 [==============================] - 0s 42ms/step - loss: 0.0518 - val_loss: 0.0277
Epoch 5/50
4/4 [==============================] - 0s 62ms/step - loss: 0.0417 - val_loss: 0.0172
Epoch 6/50
4/4 [==============================] - 0s 57ms/step - loss: 0.0332 - val_loss: 0.0091
Epoch 7/50
4/4 [==============================] - 0s 46ms/step - loss: 0.0271 - val_loss: 0.0057
Epoch 8/50
4/4 [==============================] - 0s 37ms/step - loss: 0.0271 - val_loss: 0.0076
Epoch 9/50
4/4 [==============================] - 0s 43ms/step - loss: 0.0293 - val_loss: 0.0078
Epoch 10/50
4/4 [==============================] - 0s 56ms/step - loss: 0.0282 - val_loss: 0.0061
Epoch 11/50
4/4 [==============================] - 0s 49ms/step - loss: 0.0264 - val_loss: 0.0058
Epoch 12/50
4/4 [==============================] - 0s 54ms/step - loss: 0.0258 - val_loss: 0.0065
Epoch 13/50
4/4 [==============================] - 0s 44ms/step - loss: 0.0263 - val_loss: 0.0070
Epoch 14/50
4/4 [==============================] - 0s 57ms/step - loss: 0.0266 - val_loss: 0.0072
Epoch 15/50
4/4 [==============================] - 0s 45ms/step - loss: 0.0266 - val_loss: 0.0069
Epoch 16/50
4/4 [==============================] - 0s 40ms/step - loss: 0.0263 - val_loss: 0.0064
Epoch 17/50
4/4 [==============================] - 0s 57ms/step - loss: 0.0259 - val_loss: 0.0059
Epoch 18/50
4/4 [==============================] - 0s 55ms/step - loss: 0.0256 - val_loss: 0.0058
Epoch 19/50
4/4 [==============================] - 0s 52ms/step - loss: 0.0256 - val_loss: 0.0058
Epoch 20/50
4/4 [==============================] - 0s 48ms/step - loss: 0.0255 - val_loss: 0.0059
Epoch 21/50
4/4 [==============================] - 0s 47ms/step - loss: 0.0257 - val_loss: 0.0060
Epoch 22/50
4/4 [==============================] - 0s 49ms/step - loss: 0.0255 - val_loss: 0.0058
Epoch 23/50
4/4 [==============================] - 0s 50ms/step - loss: 0.0255 - val_loss: 0.0059
Epoch 24/50
4/4 [==============================] - 0s 44ms/step - loss: 0.0257 - val_loss: 0.0060
Epoch 25/50
4/4 [==============================] - 0s 46ms/step - loss: 0.0256 - val_loss: 0.0058
Epoch 26/50
4/4 [==============================] - 0s 52ms/step - loss: 0.0254 - val_loss: 0.0058
Epoch 27/50
4/4 [==============================] - 0s 51ms/step - loss: 0.0253 - val_loss: 0.0058
Epoch 28/50
4/4 [==============================] - 0s 48ms/step - loss: 0.0253 - val_loss: 0.0058
Epoch 29/50
4/4 [==============================] - 0s 57ms/step - loss: 0.0252 - val_loss: 0.0059
Epoch 30/50
4/4 [==============================] - 0s 44ms/step - loss: 0.0252 - val_loss: 0.0059
Epoch 31/50
4/4 [==============================] - 0s 48ms/step - loss: 0.0252 - val_loss: 0.0059
Epoch 32/50
4/4 [==============================] - 0s 48ms/step - loss: 0.0252 - val_loss: 0.0059
Epoch 33/50
4/4 [==============================] - 0s 43ms/step - loss: 0.0252 - val_loss: 0.0059
Epoch 34/50
4/4 [==============================] - 0s 46ms/step - loss: 0.0252 - val_loss: 0.0059
Epoch 35/50
4/4 [==============================] - 0s 54ms/step - loss: 0.0252 - val_loss: 0.0059
Epoch 36/50
4/4 [==============================] - 0s 37ms/step - loss: 0.0251 - val_loss: 0.0059
Epoch 37/50
4/4 [==============================] - 0s 108ms/step - loss: 0.0253 - val_loss: 0.0059
Epoch 38/50
4/4 [==============================] - 0s 51ms/step - loss: 0.0251 - val_loss: 0.0059
Epoch 39/50
4/4 [==============================] - 0s 48ms/step - loss: 0.0252 - val_loss: 0.0060
Epoch 40/50
4/4 [==============================] - 0s 58ms/step - loss: 0.0251 - val_loss: 0.0060
Epoch 41/50
4/4 [==============================] - 0s 42ms/step - loss: 0.0252 - val_loss: 0.0060
Epoch 42/50
4/4 [==============================] - 0s 41ms/step - loss: 0.0251 - val_loss: 0.0059
Epoch 43/50
4/4 [==============================] - 0s 40ms/step - loss: 0.0251 - val_loss: 0.0060
Epoch 44/50
4/4 [==============================] - 0s 43ms/step - loss: 0.0253 - val_loss: 0.0062
Epoch 45/50
4/4 [==============================] - 0s 40ms/step - loss: 0.0253 - val_loss: 0.0060
Epoch 46/50
4/4 [==============================] - 0s 39ms/step - loss: 0.0250 - val_loss: 0.0059
Epoch 47/50
4/4 [==============================] - 0s 52ms/step - loss: 0.0249 - val_loss: 0.0060
Epoch 48/50
4/4 [==============================] - 0s 55ms/step - loss: 0.0250 - val_loss: 0.0062
Epoch 49/50
4/4 [==============================] - 0s 57ms/step - loss: 0.0252 - val_loss: 0.0060
Epoch 50/50
4/4 [==============================] - 0s 43ms/step - loss: 0.0250 - val_loss: 0.0060
1/1 [==============================] - 0s 390ms/step
</pre></div>
</div>
<img alt="_images/35df908a168815e5f93cae1e159dbae2bf700e08321510a1bbea9f5ecfc2301b.png" src="_images/35df908a168815e5f93cae1e159dbae2bf700e08321510a1bbea9f5ecfc2301b.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>82916.56259476597
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Graficar las predicciones del modelo ANN junto con las ventas reales</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ventas Reales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ann_predictions_rescaled</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicciones ANN&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Predicciones ANN (RMSE: </span><span class="si">{</span><span class="n">rmse_ann</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Índice&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ventas Semanales (USD)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Mostrar el nuevo RMSE del modelo ANN</span>
<span class="n">rmse_ann</span>
</pre></div>
</div>
</div>
</div>
<p>RMSE del modelo ANN: El modelo alcanzó un RMSE de 82,454.59, lo que es significativamente menor que el RMSE del modelo ARIMA (148,022.71), lo que sugiere que el modelo de redes neuronales (ANN) ofrece mejores predicciones para este conjunto de datos.</p>
<p>Comportamiento de las predicciones: En la gráfica se nota que el modelo ANN tiende a suavizar las fluctuaciones, capturando la tendencia general de las ventas, pero no logra seguir con precisión los picos y caídas abruptas. Esto puede deberse a la naturaleza del modelo y al hecho de que los picos bruscos son más difíciles de predecir.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Paso 1: Obtener los residuales del modelo ARIMA</span>
<span class="n">arima_residuals</span> <span class="o">=</span> <span class="n">store_1_sales</span> <span class="o">-</span> <span class="n">sarima_predictions</span>

<span class="c1"># Normalizar los residuales para ser utilizados en el ANN</span>
<span class="n">arima_residuals_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">arima_residuals</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Crear secuencias temporales de los residuales (ventana de 12 semanas)</span>
<span class="n">X_residuals</span><span class="p">,</span> <span class="n">y_residuals</span> <span class="o">=</span> <span class="n">create_sequences</span><span class="p">(</span><span class="n">arima_residuals_scaled</span><span class="p">,</span> <span class="n">window_size</span><span class="p">)</span>

<span class="c1"># Dividir los datos de residuales en conjuntos de entrenamiento y prueba</span>
<span class="n">X_train_residuals</span><span class="p">,</span> <span class="n">X_test_residuals</span><span class="p">,</span> <span class="n">y_train_residuals</span><span class="p">,</span> <span class="n">y_test_residuals</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_residuals</span><span class="p">,</span> <span class="n">y_residuals</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Paso 2: Entrenar el modelo ANN con los residuales</span>
<span class="n">model_residuals</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model_residuals</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">window_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>  <span class="c1"># Capa LSTM</span>
<span class="n">model_residuals</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># Capa de salida</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compilar y entrenar el modelo</span>
<span class="n">model_residuals</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mean_squared_error&#39;</span><span class="p">)</span>
<span class="n">history_residuals</span> <span class="o">=</span> <span class="n">model_residuals</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_residuals</span><span class="p">,</span> <span class="n">y_train_residuals</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test_residuals</span><span class="p">,</span> <span class="n">y_test_residuals</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Realizar predicciones con el modelo ANN en los residuales</span>
<span class="n">residual_predictions</span> <span class="o">=</span> <span class="n">model_residuals</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_residuals</span><span class="p">)</span>

<span class="c1"># Desnormalizar las predicciones de los residuales</span>
<span class="n">residual_predictions_rescaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">residual_predictions</span><span class="p">)</span>

<span class="c1"># Paso 3: Combinar las predicciones del modelo ARIMA y ANN</span>
<span class="n">final_predictions</span> <span class="o">=</span> <span class="n">sarima_predictions</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">residual_predictions_rescaled</span><span class="p">):]</span> <span class="o">+</span> <span class="n">residual_predictions_rescaled</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="c1"># Paso 4: Evaluación del modelo híbrido (ANN + ARIMA)</span>
<span class="n">rmse_hybrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">store_1_sales</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">final_predictions</span><span class="p">):],</span> <span class="n">final_predictions</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Graficar las predicciones del modelo híbrido junto con las ventas reales</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">store_1_sales</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">final_predictions</span><span class="p">):],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ventas Reales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">final_predictions</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicciones Híbrido (ARIMA + ANN)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Predicciones Híbrido ARIMA + ANN (RMSE: </span><span class="si">{</span><span class="n">rmse_hybrid</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ventas Semanales (USD)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Mostrar el RMSE del modelo híbrido</span>
<span class="n">rmse_hybrid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">32</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Paso 1: Obtener los residuales del modelo ARIMA</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">arima_residuals</span> <span class="o">=</span> <span class="n">store_1_sales</span> <span class="o">-</span> <span class="n">sarima_predictions</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># Normalizar los residuales para ser utilizados en el ANN</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">arima_residuals_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">arima_residuals</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="ne">NameError</span>: name &#39;sarima_predictions&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p><strong>Bonificacion series de tiempo</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>

<span class="c1"># Crear una tabla con los resultados finales</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;Holt-Winters (Validación)&quot;</span><span class="p">,</span> <span class="mf">0.2042</span><span class="p">,</span> <span class="mf">0.0197</span><span class="p">,</span> <span class="mf">0.0233</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6032</span><span class="p">,</span> <span class="mf">0.000543</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;Holt-Winters (Prueba)&quot;</span><span class="p">,</span> <span class="mf">0.1836</span><span class="p">,</span> <span class="mf">0.0169</span><span class="p">,</span> <span class="mf">0.0207</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4132</span><span class="p">,</span> <span class="mf">0.000429</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;ARIMA (Validación)&quot;</span><span class="p">,</span> <span class="mf">0.1868</span><span class="p">,</span> <span class="mf">0.0180</span><span class="p">,</span> <span class="mf">0.0218</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4014</span><span class="p">,</span> <span class="mf">0.000475</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;ARIMA (Prueba)&quot;</span><span class="p">,</span> <span class="mf">0.1525</span><span class="p">,</span> <span class="mf">0.0157</span><span class="p">,</span> <span class="mf">0.0195</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2543</span><span class="p">,</span> <span class="mf">0.000381</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Convertir a DataFrame</span>
<span class="n">df_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Modelo&quot;</span><span class="p">,</span> <span class="s2">&quot;MAPE (%)&quot;</span><span class="p">,</span> <span class="s2">&quot;MAE&quot;</span><span class="p">,</span> <span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="s2">&quot;R²&quot;</span><span class="p">,</span> <span class="s2">&quot;MSE&quot;</span><span class="p">])</span>

<span class="c1"># Mostrar la tabla en formato tabulado</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">df_results</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">&quot;keys&quot;</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;github&quot;</span><span class="p">,</span> <span class="n">showindex</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>| Modelo                    |   MAPE (%) |    MAE |   RMSE |      R² |      MSE |
|---------------------------|------------|--------|--------|---------|----------|
| Holt-Winters (Validación) |     0.2042 | 0.0197 | 0.0233 | -0.6032 | 0.000543 |
| Holt-Winters (Prueba)     |     0.1836 | 0.0169 | 0.0207 | -0.4132 | 0.000429 |
| ARIMA (Validación)        |     0.1868 | 0.018  | 0.0218 | -0.4014 | 0.000475 |
| ARIMA (Prueba)            |     0.1525 | 0.0157 | 0.0195 | -0.2543 | 0.000381 |
</pre></div>
</div>
</div>
</div>
<p>Conclusión</p>
<p>ARIMA muestra un mejor rendimiento general en comparación con Holt-Winters, según las métricas clave: RMSE, MAE, MAPE y R².
Ambos modelos tienen un R² negativo, lo que indica que no capturan perfectamente la variabilidad de los datos. Sin embargo, ARIMA presenta menos error y una mejor capacidad predictiva.
ARIMA también mostró un menor MAPE (error porcentual), lo que sugiere que sus predicciones están más cerca de los valores reales en términos porcentuales.</p>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="simple visible nav section-nav flex-column">
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Sergio Silvera Murcia
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>