

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Bonificaci贸n Pr谩ctica 1 &#8212; EDA Dataset Walmart</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'BonificacionPractica1';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Predicci贸n de la Demanda en Tiendas Walmart Utilizando un Enfoque H铆brido SARIMA y MLP" href="EDADatasetWalmart.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/LogoU.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/LogoU.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Acerca de
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="EDADatasetWalmart.html"><strong><em>Predicci贸n de la Demanda en Tiendas Walmart Utilizando un Enfoque H铆brido SARIMA y MLP</em></strong></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Bonificaci贸n Pr谩ctica 1</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FBonificacionPractica1.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/BonificacionPractica1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Bonificaci贸n Pr谩ctica 1</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion">Introducci贸n</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acerca-de-los-datos">Acerca de los datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion">Implementaci贸n</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importacion-de-librerias-necesarias">Importaci贸n de librerias necesarias</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eda-conjunto-de-entrenamiento">EDA conjunto de entrenamiento</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estadisticas-basicas-conjunto-de-prueba">Estad铆sticas b谩sicas conjunto de prueba</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-ses">Implementaci贸n SES</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="bonificacion-practica-1">
<h1>Bonificaci贸n Pr谩ctica 1<a class="headerlink" href="#bonificacion-practica-1" title="Permalink to this heading">#</a></h1>
<section id="introduccion">
<h2>Introducci贸n<a class="headerlink" href="#introduccion" title="Permalink to this heading">#</a></h2>
<p>En este JBook se desarrolla el ejercicio propuesto sobre metodos de <strong><em>Suavizaci贸n Exponencial</em></strong></p>
<p>Dentro de los metodos trabajados se encuentran:</p>
<ul class="simple">
<li><p>Suavizaci贸n exponencial de primer orden</p></li>
<li><p>Suavizaci贸n exponencial de segundo orden</p></li>
<li><p>Suavizaci贸n exponencial con factor de descuento</p></li>
<li><p>Holt Winters</p></li>
</ul>
</section>
<section id="acerca-de-los-datos">
<h2>Acerca de los datos<a class="headerlink" href="#acerca-de-los-datos" title="Permalink to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Dataset Propuesto</p>
<p>El dataset propuesto para la presente pr谩ctica consiste en mediciones de la potencia el茅ctrica correspondientes a una se帽al de control de entrada a lo largo del tiempo, recopiladas de una microturbina de gas comercial de 3 kilovatios</p>
<p>Este Dataset fue usado en el siguiente articulo: <a class="reference external" href="https://dl.acm.org/doi/fullHtml/10.1145/3632775.3661967">Knowledge-Guided Learning of Temporal Dynamics and its
Application to Gas Turbines</a></p>
</div>
<div class="tip admonition">
<p class="admonition-title"><strong>Informaci贸n Adicional:</strong></p>
<p>El conjunto de datos incluye ocho series de tiempo que describen el comportamiento de la
microturbina de gas bajo diversas condiciones. Cada serie representa un experimento separado
donde se vari贸 la se帽al de control de entrada a lo largo del tiempo y se midi贸 la potencia el茅ctrica
de salida resultante. Las series de tiempo var铆an en duraci贸n desde 6,495 hasta 11,820 puntos de
datos con una resoluci贸n de aproximadamente 1 segundo, lo que corresponde a aproximadamente
1.8 a 3.3 horas. Cada nivel de la se帽al de control de entrada corresponde a un nivel estacionario, es
decir, constante, de la potencia de salida. Cabe destacar que se observa un retraso notable en la
se帽al de salida durante las transiciones en respuesta a cambios en la se帽al de control de entrada.</p>
</div>
<div class="admonition-tabla-de-variables admonition">
<p class="admonition-title">Tabla de Variables</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Nombre de la Variable</p></th>
<th class="head"><p>Rol</p></th>
<th class="head"><p>Tipo</p></th>
<th class="head"><p>Descripci贸n</p></th>
<th class="head"><p>Unidades</p></th>
<th class="head"><p>Valores Faltantes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>time</p></td>
<td><p>ID</p></td>
<td><p>Continuo</p></td>
<td><p>Tiempo</p></td>
<td><p>segundos</p></td>
<td><p>no</p></td>
</tr>
<tr class="row-odd"><td><p>input_voltage</p></td>
<td><p>Caracter铆stica</p></td>
<td><p>Continuo</p></td>
<td><p>Voltaje de control de entrada</p></td>
<td><p>voltios</p></td>
<td><p>no</p></td>
</tr>
<tr class="row-even"><td><p>el_power</p></td>
<td><p>Objetivo</p></td>
<td><p>Continuo</p></td>
<td><p>Potencia de salida el茅ctrica</p></td>
<td><p>vatios</p></td>
<td><p>no</p></td>
</tr>
</tbody>
</table>
</div>
<p>Seg煤n la informaci贸n del dataset, tenemos 8 series de tiempo que describen un mismo fen贸meno, en este caso la potencia el茅ctrica de salida al variar la se帽al de control en el tiempo.</p>
<p>Para este caso la medicion se realiz贸 en segundos.</p>
<p>Con esta informaci贸n, al tratarse de series temporales diferentes lo m谩s conveniente es estudiar su comportamiento por separado (esto para el conjunto de entrenamiento) y luego probarlas sobre el conjunto de prueba para validar las m茅tricas de ajuste de los diferentes modelos.</p>
</section>
<section id="implementacion">
<h2>Implementaci贸n<a class="headerlink" href="#implementacion" title="Permalink to this heading">#</a></h2>
<section id="importacion-de-librerias-necesarias">
<h3>Importaci贸n de librerias necesarias<a class="headerlink" href="#importacion-de-librerias-necesarias" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">find_peaks</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.seasonal</span> <span class="kn">import</span> <span class="n">seasonal_decompose</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">adfuller</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa</span> <span class="kn">import</span> <span class="n">stattools</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span> 
<span class="kn">from</span> <span class="nn">statsmodels.tsa</span> <span class="kn">import</span> <span class="n">seasonal</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.holtwinters</span> <span class="kn">import</span> <span class="n">ExponentialSmoothing</span>
<span class="kn">from</span> <span class="nn">functions</span> <span class="kn">import</span> <span class="n">Functions</span> <span class="c1">#Personalized module of functions</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">FT</span> <span class="o">=</span> <span class="n">Functions</span><span class="p">()</span> <span class="c1"># Instantiate the class.</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="eda-conjunto-de-entrenamiento">
<h3>EDA conjunto de entrenamiento<a class="headerlink" href="#eda-conjunto-de-entrenamiento" title="Permalink to this heading">#</a></h3>
<p>Primero procedemos a calcular las estad铆sticas b谩sicas de cada uno de los datasets, para esto se hace uso de una clase previamente importada que contiene funciones predefinidas para estos c谩lculos b谩sicos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../Datasets/EjerciciosPracticos/train/ex_1.csv&quot;</span><span class="p">)</span>
<span class="n">FT</span><span class="o">.</span><span class="n">BasicStatisticsDataFrame</span><span class="p">(</span><span class="n">train1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Dataset Head</span>
        time  input_voltage     el_power
0  810.07028             10  1228.791720
1  811.06938             10  1223.041745
2  812.06848             10  1244.960866
3  813.06758             10  1229.259058
4  814.06668             10  1248.117024


<span class=" -Color -Color-Bold">Dataset Shape</span>
(9920, 3)


<span class=" -Color -Color-Bold">Dataset information</span>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 9920 entries, 0 to 9919
Data columns (total 3 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   time           9920 non-null   float64
 1   input_voltage  9920 non-null   int64  
 2   el_power       9920 non-null   float64
dtypes: float64(2), int64(1)
memory usage: 232.6 KB


<span class=" -Color -Color-Bold">Descriptive statistics</span>
               time  input_voltage     el_power
count   9920.000000    9920.000000  9920.000000
mean    5765.317878       6.822480  2162.427874
std     2861.440154       3.485288  1009.468755
min      810.070280       3.000000   932.837260
25%     3287.588505       3.000000   990.027512
50%     5765.106730      10.000000  2709.354147
75%     8243.140355      10.000000  3116.416457
max    10720.658580      10.000000  3249.891217


<span class=" -Color -Color-Bold">Missing values</span>
time             0
input_voltage    0
el_power         0
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Este primer conjunto de datos no presenta valores nulos, adem谩s de entre todos los conjuntos de entrenamiento es el que mayor media, desviaci贸n estandar y valor m谩ximo presenta</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">line_plot</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;el_power&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Power variability over time&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;el_power&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plot_hist</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribution of </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plot_box</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Boxplot of </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">Caculate_ADF</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ADF Statistic:&#39;</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value:&#39;</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Critical Values:&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;   </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_descomposition</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">period</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;additive&quot;</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">decomposition</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
    <span class="n">decomposition</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">calculate_period</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
    <span class="n">positive_frequencies</span> <span class="o">=</span> <span class="n">frequencies</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">frequencies</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
    <span class="n">magnitudes</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fft</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">frequencies</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)])</span>
    <span class="n">peak_frequency</span> <span class="o">=</span> <span class="n">positive_frequencies</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">magnitudes</span><span class="p">)]</span>
    <span class="n">period</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">peak_frequency</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">period</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">line_plot</span><span class="p">(</span><span class="n">train1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d9b37b72162dbb7ad700bd986a0e54930b4fde6eeda536ac8083f5bb9e7c8f93.png" src="_images/d9b37b72162dbb7ad700bd986a0e54930b4fde6eeda536ac8083f5bb9e7c8f93.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hist</span><span class="p">(</span><span class="n">train1</span><span class="p">,</span> <span class="s2">&quot;input_voltage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6f4e186259f7186854ede8886dfca6fe3169e3f2736c263a028609e70e7d066b.png" src="_images/6f4e186259f7186854ede8886dfca6fe3169e3f2736c263a028609e70e7d066b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hist</span><span class="p">(</span><span class="n">train1</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/84c882f561bf37647562a71cc7a048013ed908ea62d511de2f070209483af844.png" src="_images/84c882f561bf37647562a71cc7a048013ed908ea62d511de2f070209483af844.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">period</span> <span class="o">=</span> <span class="n">calculate_period</span><span class="p">(</span><span class="n">train1</span><span class="p">[</span><span class="s1">&#39;el_power&#39;</span><span class="p">])</span>
<span class="n">period</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4960
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_descomposition</span><span class="p">(</span><span class="n">train1</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">,</span> <span class="n">period</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/161710f23c522afccdc749dcefb39bb7e9586450b185748b1c9072960219d1b2.png" src="_images/161710f23c522afccdc749dcefb39bb7e9586450b185748b1c9072960219d1b2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">));</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">train1</span><span class="p">[</span><span class="s1">&#39;el_power&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">8000</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 550x550 with 0 Axes&gt;
</pre></div>
</div>
<img alt="_images/7184eecfe2df9026cd0e0afb67c434fbf6f97900ab9e23b5dc6f1e780ba90058.png" src="_images/7184eecfe2df9026cd0e0afb67c434fbf6f97900ab9e23b5dc6f1e780ba90058.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Caculate_ADF</span><span class="p">(</span><span class="n">train1</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Statistic: -2.880034779003427
p-value: 0.047719427772114374
Critical Values:
   1%, -3.4310119774951406
Critical Values:
   5%, -2.861832554286939
Critical Values:
   10%, -2.566925721514317
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_order_diff</span> <span class="o">=</span> <span class="n">train1</span><span class="p">[</span><span class="s1">&#39;el_power&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>
<span class="n">train1</span><span class="p">[</span><span class="s1">&#39;el_power&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Close values of DJIA during Jan 2016-Dec 2016&#39;</span><span class="p">);</span>
<span class="n">first_order_diff</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;First-order differences of DJIA during Jan 2016-Dec 2016&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/13f3928cc848211e528e3d8f206195a4b1fc7b0f4fdb5849bae8123232d9807b.png" src="_images/13f3928cc848211e528e3d8f206195a4b1fc7b0f4fdb5849bae8123232d9807b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seasonal_diff</span> <span class="o">=</span> <span class="n">train1</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">4960</span><span class="p">)</span>
<span class="n">seasonal_diff</span> <span class="o">=</span> <span class="n">seasonal_diff</span><span class="p">[</span><span class="mi">4960</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Seasonal differences&#39;</span><span class="p">);</span>
<span class="n">seasonal_diff</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2aab45c5d8ab14d5703d6849a846b2f09bb43383ea93f79853280441c5865fd2.png" src="_images/2aab45c5d8ab14d5703d6849a846b2f09bb43383ea93f79853280441c5865fd2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train9</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../Datasets/EjerciciosPracticos/train/ex_9.csv&quot;</span><span class="p">)</span>
<span class="n">FT</span><span class="o">.</span><span class="n">BasicStatisticsDataFrame</span><span class="p">(</span><span class="n">train9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Dataset Head</span>
     time  input_voltage     el_power
0  818.84          3.445  1253.790314
1  819.84          3.445  1349.836854
2  820.84          3.445  1262.033813
3  821.84          3.445  1370.205819
4  822.84          3.445  1254.782490


<span class=" -Color -Color-Bold">Dataset Shape</span>
(11819, 3)


<span class=" -Color -Color-Bold">Dataset information</span>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 11819 entries, 0 to 11818
Data columns (total 3 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   time           11819 non-null  float64
 1   input_voltage  11819 non-null  float64
 2   el_power       11819 non-null  float64
dtypes: float64(3)
memory usage: 277.1 KB


<span class=" -Color -Color-Bold">Descriptive statistics</span>
              time  input_voltage      el_power
count  11819.00000   11819.000000  11819.000000
mean    6727.84000       5.538021   1828.548454
std     3411.99575       1.397095    402.170208
min      818.84000       3.445000   1204.205671
25%     3773.34000       4.305000   1449.908790
50%     6727.84000       5.790000   1735.783127
75%     9682.34000       6.880000   2247.396267
max    12636.84000       7.240000   2511.698262


<span class=" -Color -Color-Bold">Missing values</span>
time             0
input_voltage    0
el_power         0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">line_plot</span><span class="p">(</span><span class="n">train9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bba46e12bc2bbf728dd7cdb8e300aba374c0952c0e30af29f64eab32931cb711.png" src="_images/bba46e12bc2bbf728dd7cdb8e300aba374c0952c0e30af29f64eab32931cb711.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hist</span><span class="p">(</span><span class="n">train9</span><span class="p">,</span> <span class="s2">&quot;input_voltage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/387a7db4cf98dfe7154d97c059a64884925eb1f553feeebb7e494ed632180988.png" src="_images/387a7db4cf98dfe7154d97c059a64884925eb1f553feeebb7e494ed632180988.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hist</span><span class="p">(</span><span class="n">train9</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7a4377d1c93358e3e146a04bc107d326b2b492014b4d017a2b491903e7d4b22a.png" src="_images/7a4377d1c93358e3e146a04bc107d326b2b492014b4d017a2b491903e7d4b22a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_descomposition</span><span class="p">(</span><span class="n">train9</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4d68a38488aee355713930f756d214cea1d452dec46ece9b16411f2003f2fd39.png" src="_images/4d68a38488aee355713930f756d214cea1d452dec46ece9b16411f2003f2fd39.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Caculate_ADF</span><span class="p">(</span><span class="n">train9</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Statistic: -0.2662656661214094
p-value: 0.9301480968227475
Critical Values:
   1%, -3.430905051344695
Critical Values:
   5%, -2.861785303766895
Critical Values:
   10%, -2.5669005701267875
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">));</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">train9</span><span class="p">[</span><span class="s1">&#39;el_power&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">8000</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 550x550 with 0 Axes&gt;
</pre></div>
</div>
<img alt="_images/c1bc4e4f3b0aa0c72646b9fb549169fb3d655677d275bb6c47ab109ce762d3c9.png" src="_images/c1bc4e4f3b0aa0c72646b9fb549169fb3d655677d275bb6c47ab109ce762d3c9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train20</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../Datasets/EjerciciosPracticos/train/ex_20.csv&quot;</span><span class="p">)</span>
<span class="n">FT</span><span class="o">.</span><span class="n">BasicStatisticsDataFrame</span><span class="p">(</span><span class="n">train20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Dataset Head</span>
     time  input_voltage     el_power
0  849.22            3.0  1238.511285
1  850.24            3.0  1149.563728
2  851.26            3.0  1226.959165
3  852.28            3.0  1158.086961
4  853.30            3.0  1230.435294


<span class=" -Color -Color-Bold">Dataset Shape</span>
(6495, 3)


<span class=" -Color -Color-Bold">Dataset information</span>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 6495 entries, 0 to 6494
Data columns (total 3 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   time           6495 non-null   float64
 1   input_voltage  6495 non-null   float64
 2   el_power       6495 non-null   float64
dtypes: float64(3)
memory usage: 152.4 KB


<span class=" -Color -Color-Bold">Descriptive statistics</span>
              time  input_voltage     el_power
count  6495.000000    6495.000000  6495.000000
mean   4285.243504       4.655119  1623.263494
std    2015.543637       2.481296   632.985147
min     849.220000       3.000000  1097.030791
25%    2534.680000       3.000000  1158.548696
50%    4252.160000       3.000000  1241.345876
75%    6019.240000       5.000000  1909.031616
max    7824.000000      10.000000  3182.431061


<span class=" -Color -Color-Bold">Missing values</span>
time             0
input_voltage    0
el_power         0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">line_plot</span><span class="p">(</span><span class="n">train20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1b3d52dc2b19c091a002f6734b6f1e7e9e6da62b8a40b58ca21206bf7ade9fdc.png" src="_images/1b3d52dc2b19c091a002f6734b6f1e7e9e6da62b8a40b58ca21206bf7ade9fdc.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hist</span><span class="p">(</span><span class="n">train20</span><span class="p">,</span> <span class="s2">&quot;input_voltage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/93e2d13c3ba849398db62ab51360e59313d1375e073f22ceefd548b053ad2a3f.png" src="_images/93e2d13c3ba849398db62ab51360e59313d1375e073f22ceefd548b053ad2a3f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hist</span><span class="p">(</span><span class="n">train20</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/056a1b800483351d0cc1a875d596707fc365cabe88a56e0c8486f193a63a1a9b.png" src="_images/056a1b800483351d0cc1a875d596707fc365cabe88a56e0c8486f193a63a1a9b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Caculate_ADF</span><span class="p">(</span><span class="n">train20</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Statistic: -3.391959550174136
p-value: 0.011236042963495362
Critical Values:
   1%, -3.431362678073597
Critical Values:
   5%, -2.861987516467093
Critical Values:
   10%, -2.567008209725963
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_descomposition</span><span class="p">(</span><span class="n">train20</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">,</span> <span class="mi">1500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b3c5b4dcbc6cb862f4e5ad96ffef98fbedc2412fbf1152094640feb67bb76361.png" src="_images/b3c5b4dcbc6cb862f4e5ad96ffef98fbedc2412fbf1152094640feb67bb76361.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">));</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">train20</span><span class="p">[</span><span class="s1">&#39;el_power&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">6000</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 550x550 with 0 Axes&gt;
</pre></div>
</div>
<img alt="_images/660162c990ae90c0c240aa8e323dd14bd30b2e633fc096ce06d8c06685cd57c0.png" src="_images/660162c990ae90c0c240aa8e323dd14bd30b2e633fc096ce06d8c06685cd57c0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train21</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../Datasets/EjerciciosPracticos/train/ex_21.csv&quot;</span><span class="p">)</span>
<span class="n">FT</span><span class="o">.</span><span class="n">BasicStatisticsDataFrame</span><span class="p">(</span><span class="n">train21</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Dataset Head</span>
     time  input_voltage     el_power
0  847.72            3.0  1089.895066
1  848.74            3.0  1179.843179
2  849.78            3.0  1099.497553
3  850.80            3.0  1181.551142
4  851.82            3.0  1100.823819


<span class=" -Color -Color-Bold">Dataset Shape</span>
(6495, 3)


<span class=" -Color -Color-Bold">Dataset information</span>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 6495 entries, 0 to 6494
Data columns (total 3 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   time           6495 non-null   float64
 1   input_voltage  6495 non-null   float64
 2   el_power       6495 non-null   float64
dtypes: float64(3)
memory usage: 152.4 KB


<span class=" -Color -Color-Bold">Descriptive statistics</span>
              time  input_voltage     el_power
count  6495.000000    6495.000000  6495.000000
mean   4252.303279       4.658276  1576.460277
std    1999.890706       2.479646   638.042444
min     847.720000       3.000000  1045.541020
25%    2513.030000       3.000000  1112.552610
50%    4217.520000       3.000000  1191.245597
75%    5971.160000       5.000000  1889.461847
max    7776.600000      10.000000  3191.966802


<span class=" -Color -Color-Bold">Missing values</span>
time             0
input_voltage    0
el_power         0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">line_plot</span><span class="p">(</span><span class="n">train21</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/51867bc8a112183bf233b784062628df420002d591853dd7267ed14e9303d94c.png" src="_images/51867bc8a112183bf233b784062628df420002d591853dd7267ed14e9303d94c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hist</span><span class="p">(</span><span class="n">train21</span><span class="p">,</span> <span class="s2">&quot;input_voltage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0cbe720db0f18d1cfbad81977d1e5fa79f7d5b13784c54dd5c935b90142e559a.png" src="_images/0cbe720db0f18d1cfbad81977d1e5fa79f7d5b13784c54dd5c935b90142e559a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hist</span><span class="p">(</span><span class="n">train21</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5a8f0c8baa834a1e9e24b4549122367fa028b149fbbcaf7629fd121912097d77.png" src="_images/5a8f0c8baa834a1e9e24b4549122367fa028b149fbbcaf7629fd121912097d77.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Caculate_ADF</span><span class="p">(</span><span class="n">train21</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Statistic: -3.4516264318605643
p-value: 0.009319892749348871
Critical Values:
   1%, -3.4313628349215555
Critical Values:
   5%, -2.86198758576857
Critical Values:
   10%, -2.5670082466166657
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_descomposition</span><span class="p">(</span><span class="n">train21</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">,</span> <span class="mi">1500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b4a7ec171775e3d09562bcec13e0d2fd6f5e34a4d642f53e4bd69eed212ea653.png" src="_images/b4a7ec171775e3d09562bcec13e0d2fd6f5e34a4d642f53e4bd69eed212ea653.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">));</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">train21</span><span class="p">[</span><span class="s1">&#39;el_power&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">6000</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 550x550 with 0 Axes&gt;
</pre></div>
</div>
<img alt="_images/4302ebc1ee8b41292986e6e0be52866873a97b41bfd2e75b417bef9975f9eb62.png" src="_images/4302ebc1ee8b41292986e6e0be52866873a97b41bfd2e75b417bef9975f9eb62.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train23</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../Datasets/EjerciciosPracticos/train/ex_23.csv&quot;</span><span class="p">)</span>
<span class="n">FT</span><span class="o">.</span><span class="n">BasicStatisticsDataFrame</span><span class="p">(</span><span class="n">train23</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Dataset Head</span>
     time  input_voltage     el_power
0  810.00            3.0  1102.949693
1  811.04            3.0  1199.403786
2  812.08            3.0  1113.199817
3  813.18            3.0  1200.377939
4  814.18            3.0  1105.465349


<span class=" -Color -Color-Bold">Dataset Shape</span>
(9188, 3)


<span class=" -Color -Color-Bold">Dataset information</span>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 9188 entries, 0 to 9187
Data columns (total 3 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   time           9188 non-null   float64
 1   input_voltage  9188 non-null   float64
 2   el_power       9188 non-null   float64
dtypes: float64(3)
memory usage: 215.5 KB


<span class=" -Color -Color-Bold">Descriptive statistics</span>
               time  input_voltage     el_power
count   9188.000000    9188.000000  9188.000000
mean    5821.804822       5.258644  1899.231847
std     2964.155040       2.235487   693.044107
min      810.000000       3.000000  1053.218306
25%     3205.085000       3.000000  1212.052789
50%     5783.460000       4.842105  1694.534657
75%     8414.045000       7.052632  2508.555589
max    10954.520000       9.631579  3193.846351


<span class=" -Color -Color-Bold">Missing values</span>
time             0
input_voltage    0
el_power         0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">line_plot</span><span class="p">(</span><span class="n">train23</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/69d8b29312425e1df4c49c3b0e736796130fbab70aa4f75551bf5b264dfc2252.png" src="_images/69d8b29312425e1df4c49c3b0e736796130fbab70aa4f75551bf5b264dfc2252.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hist</span><span class="p">(</span><span class="n">train23</span><span class="p">,</span> <span class="s2">&quot;input_voltage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ae04e958b1476a9dadb6cdf91b464d6ab5e7bdba0bdf665d362d8fa7b14da06e.png" src="_images/ae04e958b1476a9dadb6cdf91b464d6ab5e7bdba0bdf665d362d8fa7b14da06e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hist</span><span class="p">(</span><span class="n">train23</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a5e19d4016f74b282194e39183e951eca9bcb590a7ec6d88add88b2738b8e916.png" src="_images/a5e19d4016f74b282194e39183e951eca9bcb590a7ec6d88add88b2738b8e916.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Caculate_ADF</span><span class="p">(</span><span class="n">train23</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Statistic: -4.266145547661307
p-value: 0.0005081533115464868
Critical Values:
   1%, -3.431064956354247
Critical Values:
   5%, -2.8618559649427446
Critical Values:
   10%, -2.5669381830831886
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_descomposition</span><span class="p">(</span><span class="n">train23</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c45d8e79b52ffc7afe44fe7cf95e2c818951ee2cbc1e0eee903e0486e9907df2.png" src="_images/c45d8e79b52ffc7afe44fe7cf95e2c818951ee2cbc1e0eee903e0486e9907df2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">));</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">train23</span><span class="p">[</span><span class="s1">&#39;el_power&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">6000</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 550x550 with 0 Axes&gt;
</pre></div>
</div>
<img alt="_images/b3571f5fa4abe8f90232b46861b798f66859eacea9a085426041b4eaf2bb91f8.png" src="_images/b3571f5fa4abe8f90232b46861b798f66859eacea9a085426041b4eaf2bb91f8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train24</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../Datasets/EjerciciosPracticos/train/ex_24.csv&quot;</span><span class="p">)</span>
<span class="n">FT</span><span class="o">.</span><span class="n">BasicStatisticsDataFrame</span><span class="p">(</span><span class="n">train24</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Dataset Head</span>
     time  input_voltage     el_power
0  811.04            3.0  1217.413110
1  812.04            3.0  1140.090013
2  813.06            3.0  1223.751987
3  814.10            3.0  1124.810110
4  815.12            3.0  1207.671543


<span class=" -Color -Color-Bold">Dataset Shape</span>
(9023, 3)


<span class=" -Color -Color-Bold">Dataset information</span>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 9023 entries, 0 to 9022
Data columns (total 3 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   time           9023 non-null   float64
 1   input_voltage  9023 non-null   float64
 2   el_power       9023 non-null   float64
dtypes: float64(3)
memory usage: 211.6 KB


<span class=" -Color -Color-Bold">Descriptive statistics</span>
               time  input_voltage     el_power
count   9023.000000    9023.000000  9023.000000
mean    5669.373056       5.488547  1805.375104
std     2849.219820       2.297978   680.139456
min      811.040000       3.000000  1054.175250
25%     3161.990000       3.000000  1221.472869
50%     5683.780000       5.210526  1539.209904
75%     8146.820000       7.421053  2380.490784
max    10579.600000      10.000000  3191.101416


<span class=" -Color -Color-Bold">Missing values</span>
time             0
input_voltage    0
el_power         0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">line_plot</span><span class="p">(</span><span class="n">train24</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ae3b090a1d74963db2ed9867c9d2309e6e2a2cb56128dcd66207b1c170c042d0.png" src="_images/ae3b090a1d74963db2ed9867c9d2309e6e2a2cb56128dcd66207b1c170c042d0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hist</span><span class="p">(</span><span class="n">train24</span><span class="p">,</span> <span class="s2">&quot;input_voltage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2ad052e0fcd0b01474841b2d7eb6003119da2c1d46775198aefeb9e0ed5f5fde.png" src="_images/2ad052e0fcd0b01474841b2d7eb6003119da2c1d46775198aefeb9e0ed5f5fde.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hist</span><span class="p">(</span><span class="n">train24</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c6ae69ec17ce7ccec985bbbe7c582c59070b7f89d7549736ea2eab4ab3638445.png" src="_images/c6ae69ec17ce7ccec985bbbe7c582c59070b7f89d7549736ea2eab4ab3638445.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Caculate_ADF</span><span class="p">(</span><span class="n">train24</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Statistic: -1.33738182952345
p-value: 0.6119013728890791
Critical Values:
   1%, -3.431077928889453
Critical Values:
   5%, -2.8618616972705597
Critical Values:
   10%, -2.566941234431045
</pre></div>
</div>
</div>
</div>
</section>
<section id="estadisticas-basicas-conjunto-de-prueba">
<h3>Estad铆sticas b谩sicas conjunto de prueba<a class="headerlink" href="#estadisticas-basicas-conjunto-de-prueba" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../Datasets/EjerciciosPracticos/test/ex_4.csv&quot;</span><span class="p">)</span>
<span class="n">FT</span><span class="o">.</span><span class="n">BasicStatisticsDataFrame</span><span class="p">(</span><span class="n">test4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Dataset Head</span>
         time  input_voltage     el_power
0  758.425813            3.0  1206.993434
1  759.425109            3.0  1255.072122
2  760.424406            3.0  1203.093254
3  761.423702            3.0  1259.000662
4  762.422998            3.0  1196.033782


<span class=" -Color -Color-Bold">Dataset Shape</span>
(9795, 3)


<span class=" -Color -Color-Bold">Dataset information</span>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 9795 entries, 0 to 9794
Data columns (total 3 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   time           9795 non-null   float64
 1   input_voltage  9795 non-null   float64
 2   el_power       9795 non-null   float64
dtypes: float64(3)
memory usage: 229.7 KB


<span class=" -Color -Color-Bold">Descriptive statistics</span>
               time  input_voltage     el_power
count   9795.000000    9795.000000  9795.000000
mean    5651.979106       5.548392  1938.575453
std     2825.727015       2.948274   819.978754
min      758.425813       3.000000  1109.522853
25%     3205.202460       3.000000  1223.075977
50%     5651.979106       3.000000  1602.029042
75%     8098.755753       7.500000  2547.339604
max    10545.532399      10.000000  3393.228566


<span class=" -Color -Color-Bold">Missing values</span>
time             0
input_voltage    0
el_power         0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">line_plot</span><span class="p">(</span><span class="n">test4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9a47bacfecd1b26af642e0b3a3fc22ca177f7bc934c685b96f3451f2bf958e18.png" src="_images/9a47bacfecd1b26af642e0b3a3fc22ca177f7bc934c685b96f3451f2bf958e18.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hist</span><span class="p">(</span><span class="n">test4</span><span class="p">,</span> <span class="s2">&quot;input_voltage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/33c7df4c4641efb629528d7d844f56d4ea940e775f51ceb70a87fafb29e7d943.png" src="_images/33c7df4c4641efb629528d7d844f56d4ea940e775f51ceb70a87fafb29e7d943.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Caculate_ADF</span><span class="p">(</span><span class="n">test4</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Statistic: -3.9075063089209308
p-value: 0.001980294064980506
Critical Values:
   1%, -3.4310204613998323
Critical Values:
   5%, -2.8618363032400596
Critical Values:
   10%, -2.566927717089522
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_descomposition</span><span class="p">(</span><span class="n">test4</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1ba1a3776c179a5b237f67a3d509447c5d4a3f1afc5e058e46c501527224085c.png" src="_images/1ba1a3776c179a5b237f67a3d509447c5d4a3f1afc5e058e46c501527224085c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">));</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">train23</span><span class="p">[</span><span class="s1">&#39;el_power&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">6000</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 550x550 with 0 Axes&gt;
</pre></div>
</div>
<img alt="_images/b3571f5fa4abe8f90232b46861b798f66859eacea9a085426041b4eaf2bb91f8.png" src="_images/b3571f5fa4abe8f90232b46861b798f66859eacea9a085426041b4eaf2bb91f8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test22</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../Datasets/EjerciciosPracticos/test/ex_22.csv&quot;</span><span class="p">)</span>
<span class="n">FT</span><span class="o">.</span><span class="n">BasicStatisticsDataFrame</span><span class="p">(</span><span class="n">test22</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Dataset Head</span>
    time  input_voltage     el_power
0  880.3            3.0  1193.140713
1  881.3            3.0  1107.066421
2  882.3            3.0  1180.406767
3  883.3            3.0  1095.551498
4  884.3            3.0  1177.073719


<span class=" -Color -Color-Bold">Dataset Shape</span>
(8490, 3)


<span class=" -Color -Color-Bold">Dataset information</span>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 8490 entries, 0 to 8489
Data columns (total 3 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   time           8490 non-null   float64
 1   input_voltage  8490 non-null   float64
 2   el_power       8490 non-null   float64
dtypes: float64(3)
memory usage: 199.1 KB


<span class=" -Color -Color-Bold">Descriptive statistics</span>
               time  input_voltage     el_power
count   8490.000000    8490.000000  8490.000000
mean    5594.452214       6.167342  1976.710064
std     2801.610165       2.671462   795.040249
min      880.300000       3.000000  1022.500305
25%     3094.255000       3.000000  1186.554473
50%     5593.990000       5.958328  1724.777344
75%     8033.565000       8.734064  2857.849102
max    10427.580000      10.000000  3184.621625


<span class=" -Color -Color-Bold">Missing values</span>
time             0
input_voltage    0
el_power         0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">line_plot</span><span class="p">(</span><span class="n">test22</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3d99749dfb704f156bc19811f1241a2f582eed937d55352f5e849a69f1e6a5e3.png" src="_images/3d99749dfb704f156bc19811f1241a2f582eed937d55352f5e849a69f1e6a5e3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hist</span><span class="p">(</span><span class="n">test22</span><span class="p">,</span> <span class="s2">&quot;input_voltage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0b52c61cc32ac1851451f860a9fee0e099d32566962f68d48565129c34dd5b48.png" src="_images/0b52c61cc32ac1851451f860a9fee0e099d32566962f68d48565129c34dd5b48.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hist</span><span class="p">(</span><span class="n">test22</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8df2d0909f006e49949d61551d62686e94a260a0f12e9201e60d8de1153fea78.png" src="_images/8df2d0909f006e49949d61551d62686e94a260a0f12e9201e60d8de1153fea78.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Caculate_ADF</span><span class="p">(</span><span class="n">test22</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Statistic: -3.9657803308975184
p-value: 0.001600685011029706
Critical Values:
   1%, -3.431123933643013
Critical Values:
   5%, -2.861882025734385
Critical Values:
   10%, -2.5669520554126093
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_descomposition</span><span class="p">(</span><span class="n">test22</span><span class="p">,</span> <span class="s2">&quot;el_power&quot;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/70173fc9e0613c871b7cb191d85ca13bb831b80041679e1d50df1fc3528985a9.png" src="_images/70173fc9e0613c871b7cb191d85ca13bb831b80041679e1d50df1fc3528985a9.png" />
</div>
</div>
</section>
</section>
<section id="implementacion-ses">
<h2>Implementaci贸n SES<a class="headerlink" href="#implementacion-ses" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train1</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">train1</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>
<span class="n">train1</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">SES_train1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train1</span><span class="p">[</span><span class="s1">&#39;el_power&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">train1</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="n">SES_train1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time
810.07028      1228.791720
811.06938      1223.041745
812.06848      1244.960866
813.06758      1229.259058
814.06668      1248.117024
                  ...     
10716.66218     962.030262
10717.66128     963.213626
10718.66038     947.956869
10719.65948     944.314505
10720.65858     968.184917
Length: 9920, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">ytilde</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Acceder al primer valor por posici贸n</span>
    <span class="n">ytilde</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)</span> <span class="o">*</span> <span class="n">start</span>  <span class="c1"># Usar iloc para acceder al valor</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
        <span class="n">ytilde</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)</span> <span class="o">*</span> <span class="n">ytilde</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># Usar iloc para la posici贸n</span>
    <span class="k">return</span> <span class="n">ytilde</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FirstS_SES_train1</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">SES_train1</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">SES_train1</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;power&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">SES_train1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SES $\lambda=0.4$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;power&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/61d5e7bfabc68336c07f3a3f77a7e1e7bafc3037c91afd79bf4f95f4c62fa957.png" src="_images/61d5e7bfabc68336c07f3a3f77a7e1e7bafc3037c91afd79bf4f95f4c62fa957.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">measacc_fs</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">yh</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">out</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
    <span class="n">prederr</span> <span class="o">=</span> <span class="n">yh</span> <span class="o">-</span> <span class="n">out</span>
    <span class="n">SSE</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prederr</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">MAPE</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span> <span class="o">/</span> <span class="n">yh</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
    <span class="n">MAD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
    <span class="n">MSD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prederr</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">T</span>
    <span class="n">ret1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s2">&quot;SSE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">SSE</span><span class="p">],</span>
        <span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MAPE</span><span class="p">],</span>
        <span class="s2">&quot;MAD&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MAD</span><span class="p">],</span>
        <span class="s2">&quot;MSD&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MSD</span><span class="p">]</span>
    <span class="p">})</span>
    <span class="n">ret1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret1</span>

<span class="n">measacc_fs</span><span class="p">(</span><span class="n">SES_train1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SSE</th>
      <th>MAPE</th>
      <th>MAD</th>
      <th>MSD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.041790e+06</td>
      <td>0.741687</td>
      <td>12.863716</td>
      <td>205.825566</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power_smooth1</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">SES_train1</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power_smooth2</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">power_smooth1</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power_hat</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">power_smooth1</span> <span class="o">-</span> <span class="n">power_smooth2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">SES_train1</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Power&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">power_hat</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;DES $\lambda=0.4$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a97f9c304d3e0b8d1cbfad271ae139d4e2d7f26cae8a08549e702979c2515d9e.png" src="_images/a97f9c304d3e0b8d1cbfad271ae139d4e2d7f26cae8a08549e702979c2515d9e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tlsmooth</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">delta_</span><span class="p">,</span> <span class="n">y_tilde_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lambda_start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    
    <span class="n">Qt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">y_tilde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">lambd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    
    <span class="n">lambd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lambda_start</span>
    <span class="k">if</span> <span class="n">y_tilde_start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y_tilde</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Usar .iloc para acceso posicional</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y_tilde</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_tilde_start</span>  <span class="c1"># Error aqu铆, deber铆a ser y_tilde[0]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">err</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_tilde</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Usar .iloc para acceder a y</span>
        <span class="n">Qt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta_</span> <span class="o">*</span> <span class="n">err</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">delta_</span><span class="p">)</span> <span class="o">*</span> <span class="n">Qt</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Dt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta_</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">err</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">delta_</span><span class="p">)</span> <span class="o">*</span> <span class="n">Dt</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">lambd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Qt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">Dt</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">y_tilde</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lambd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambd</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">y_tilde</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Usar .iloc en y</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">y_tilde</span><span class="p">,</span> <span class="n">lambd</span><span class="p">,</span> <span class="n">err</span><span class="p">,</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">Dt</span><span class="p">))</span>

<span class="n">out_tl_dji</span> <span class="o">=</span> <span class="n">tlsmooth</span><span class="p">(</span><span class="n">SES_train1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out_power</span> <span class="o">=</span> <span class="n">tlsmooth</span><span class="p">(</span><span class="n">SES_train1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_smoothed_data</span><span class="p">(</span><span class="n">SES_train1</span><span class="p">,</span> <span class="n">out_power</span><span class="p">,</span> <span class="n">power_smooth1</span><span class="p">,</span> <span class="n">last_fc</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="c1"># Asegurarse de que out_power sea un DataFrame</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out_power</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">tl_smoothed</span> <span class="o">=</span> <span class="n">out_power</span><span class="p">[</span><span class="s1">&#39;y_tilde&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tl_smoothed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">out_power</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">SES_train1</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    
    <span class="c1"># Asegurarse de que power_smooth1 sea una Serie</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">power_smooth1</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="n">power_smooth1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">power_smooth1</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">SES_train1</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    
    <span class="c1"># Tomar los 煤ltimos last_fc puntos de todas las series</span>
    <span class="n">SES_last</span> <span class="o">=</span> <span class="n">SES_train1</span><span class="p">[</span><span class="o">-</span><span class="n">last_fc</span><span class="p">:]</span>
    <span class="n">tl_last</span> <span class="o">=</span> <span class="n">tl_smoothed</span><span class="p">[</span><span class="o">-</span><span class="n">last_fc</span><span class="p">:]</span>
    <span class="n">exp_last</span> <span class="o">=</span> <span class="n">power_smooth1</span><span class="p">[</span><span class="o">-</span><span class="n">last_fc</span><span class="p">:]</span>
    
    <span class="c1"># Crear el gr谩fico</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">SES_last</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">SES_last</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Dow Jones&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tl_last</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">tl_last</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;TL Smoother&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">exp_last</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">exp_last</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exponential Smoother&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Dow Jones&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Comparison of Smoothing Methods (Last </span><span class="si">{</span><span class="n">last_fc</span><span class="si">}</span><span class="s1"> Points)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Ejemplo de uso:</span>
<span class="n">plot_smoothed_data</span><span class="p">(</span><span class="n">SES_train1</span><span class="p">,</span> <span class="n">out_power</span><span class="p">,</span> <span class="n">power_smooth1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/893de07f5d5f2bba6bb0a9db0407cd34b150c0960d2a1751d239f371310ae49c.png" src="_images/893de07f5d5f2bba6bb0a9db0407cd34b150c0960d2a1751d239f371310ae49c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tau_test</span> <span class="o">=</span> <span class="mi">48</span>
<span class="n">tau_val</span>  <span class="o">=</span> <span class="mi">48</span>    

<span class="n">train</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="p">(</span><span class="n">tau_val</span> <span class="o">+</span> <span class="n">tau_test</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">val</span>   <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">tau_val</span> <span class="o">+</span> <span class="n">tau_test</span><span class="p">):</span><span class="o">-</span><span class="n">tau_test</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">test</span>  <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="n">tau_test</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Train: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">)</span><span class="si">}</span><span class="s2">, Validation: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="si">}</span><span class="s2">, Test: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">72</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">tau_test</span> <span class="o">=</span> <span class="mi">48</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">tau_val</span>  <span class="o">=</span> <span class="mi">48</span>    
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="n">train</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="p">(</span><span class="n">tau_val</span> <span class="o">+</span> <span class="n">tau_test</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">val</span>   <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">tau_val</span> <span class="o">+</span> <span class="n">tau_test</span><span class="p">):</span><span class="o">-</span><span class="n">tau_test</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">test</span>  <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="n">tau_test</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;y&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tools.sm_exceptions</span> <span class="kn">import</span> <span class="n">ConvergenceWarning</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">ConvergenceWarning</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.holtwinters</span> <span class="kn">import</span> <span class="n">ExponentialSmoothing</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.holtwinters</span> <span class="kn">import</span> <span class="n">SimpleExpSmoothing</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.seasonal</span> <span class="kn">import</span> <span class="n">seasonal_decompose</span>
<span class="kn">import</span> <span class="nn">statsmodels.tsa.api</span> <span class="k">as</span> <span class="nn">smt</span>
<span class="k">def</span> <span class="nf">tes_optimizer</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">abg</span><span class="p">,</span> <span class="n">trend</span><span class="p">,</span> <span class="n">seasonal</span><span class="p">,</span>  <span class="n">seasonal_periods</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
    
    <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_beta</span><span class="p">,</span> <span class="n">best_gamma</span><span class="p">,</span> <span class="n">best_mae</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="n">abg</span><span class="p">:</span>
        <span class="n">tes_model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="n">trend</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="n">seasonal</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="o">=</span><span class="n">seasonal_periods</span><span class="p">)</span><span class="o">.</span>\
            <span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">comb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">smoothing_slope</span><span class="o">=</span><span class="n">comb</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">smoothing_seasonal</span><span class="o">=</span><span class="n">comb</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">tes_model</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mae</span> <span class="o">&lt;</span> <span class="n">best_mae</span><span class="p">:</span>
            <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_beta</span><span class="p">,</span> <span class="n">best_gamma</span><span class="p">,</span> <span class="n">best_mae</span> <span class="o">=</span> <span class="n">comb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">comb</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">comb</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">mae</span>

    <span class="k">return</span> <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_beta</span><span class="p">,</span> <span class="n">best_gamma</span><span class="p">,</span> <span class="n">best_mae</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tes_model_tuning</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">trend</span><span class="p">,</span> <span class="n">seasonal</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Model Tuning - Triple Exponential Smoothing&quot;</span><span class="p">):</span>
    
    <span class="n">alphas</span> <span class="o">=</span> <span class="n">betas</span> <span class="o">=</span> <span class="n">gammas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">)</span>
    <span class="n">abg</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">alphas</span><span class="p">,</span> <span class="n">betas</span><span class="p">,</span> <span class="n">gammas</span><span class="p">))</span>
    <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_beta</span><span class="p">,</span> <span class="n">best_gamma</span><span class="p">,</span> <span class="n">best_mae</span> <span class="o">=</span> <span class="n">tes_optimizer</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">abg</span><span class="o">=</span><span class="n">abg</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="n">trend</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="n">seasonal</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="o">=</span><span class="n">seasonal_periods</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>
    
    <span class="n">final_model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="n">trend</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="n">seasonal</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">best_alpha</span><span class="p">,</span> <span class="n">smoothing_slope</span><span class="o">=</span><span class="n">best_beta</span><span class="p">,</span> <span class="n">smoothing_seasonal</span><span class="o">=</span><span class="n">best_gamma</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">final_model</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">step</span> <span class="o">+</span> <span class="n">step</span><span class="p">)[</span><span class="o">-</span><span class="n">step</span><span class="p">:]</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    
    <span class="n">plot_model</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_beta</span><span class="p">,</span> <span class="n">best_gamma</span><span class="p">,</span> <span class="n">best_mae</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_beta</span><span class="p">,</span> <span class="n">best_gamma</span><span class="p">,</span> <span class="n">best_mae</span> <span class="o">=</span> <span class="n">tes_model_tuning</span><span class="p">(</span><span class="n">SES_train1</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">tau_test</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="EDADatasetWalmart.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong><em>Predicci贸n de la Demanda en Tiendas Walmart Utilizando un Enfoque H铆brido SARIMA y MLP</em></strong></p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion">Introducci贸n</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acerca-de-los-datos">Acerca de los datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion">Implementaci贸n</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importacion-de-librerias-necesarias">Importaci贸n de librerias necesarias</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eda-conjunto-de-entrenamiento">EDA conjunto de entrenamiento</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estadisticas-basicas-conjunto-de-prueba">Estad铆sticas b谩sicas conjunto de prueba</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-ses">Implementaci贸n SES</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Sergio Silvera Murcia
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      漏 Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>